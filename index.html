<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP-ArchaeoVision Elite | İsmail Polat</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #00ff88; --danger: #ff4444; --bg-deep: #020403; --panel: rgba(10, 15, 12, 0.98); }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg-deep); color: #fff; font-family: 'Inter', sans-serif; overflow: hidden; }
        .dashboard { display: grid; grid-template-columns: 380px 1fr 300px; height: 100vh; }
        .sidebar-left, .sidebar-right { background: var(--panel); border: 1px solid #1a2a20; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        #map { height: 100%; width: 100%; background: #000; }
        .card { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 15px; }
        .btn-scan { background: linear-gradient(45deg, #00bd65, var(--primary)); color: #000; border: none; padding: 15px; font-family: 'Orbitron', sans-serif; font-weight: bold; border-radius: 4px; cursor: pointer; transition: 0.3s; width: 100%; }
        .btn-kml { background: none; color: #44aaff; border: 1px solid #44aaff; padding: 10px; margin-top: 10px; cursor: pointer; width: 100%; border-radius: 4px; font-family: 'Orbitron', sans-serif; font-size: 10px; }
        .terminal { background: #000; font-family: 'JetBrains Mono', monospace; font-size: 10px; padding: 10px; height: 200px; overflow-y: auto; color: var(--primary); }
        .scanning-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: var(--primary); box-shadow: 0 0 20px var(--primary); z-index: 1001; display: none; animation: scanLine 2s linear infinite; }
        @keyframes scanLine { 0% { top: 0; } 100% { top: 100%; } }
    </style>
</head>
<body>

<div class="dashboard">
    <aside class="sidebar-left">
        <div style="text-align:center; border-bottom:1px solid var(--primary); padding-bottom:10px;">
            <h1 style="font-family:'Orbitron'; color:var(--primary); font-size:1.4rem; margin:0;">IP-ARCHEO v3.1</h1>
            <small>GLOBAL FIELD INTELLIGENCE</small>
        </div>
        <div class="card">
            <h4 style="margin:0; font-size:10px; color:var(--primary);">HEDEF: ELBİSTAN</h4>
            <p style="font-size:12px;">38.2052° N, 37.1986° E</p>
        </div>
        <button class="btn-scan" onclick="startDeepAnalysis()">ANALİZİ BAŞLAT</button>
        <button class="btn-kml" onclick="exportKML()">GOOGLE EARTH (KML) İNDİR</button>
        <div class="card" style="margin-top:auto;">
            <small style="color:#666;">Analist: İsmail Polat</small>
        </div>
    </aside>

    <main style="position:relative;">
        <div id="scanner" class="scanning-overlay"></div>
        <div id="map"></div>
    </main>

    <aside class="sidebar-right">
        <div class="card" style="text-align:center;">
            <h4 style="margin:0;">BULGU SAYISI</h4>
            <div id="detect-count" style="font-size:2.5rem; color:var(--primary); font-weight:bold;">0</div>
        </div>
        <div class="terminal" id="term-box">> Sistem hazır...</div>
    </aside>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const map = L.map('map', { zoomControl: false }).setView([38.2052, 37.1986], 13);
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}').addTo(map);

    let foundLocations = [];

    function writeLog(msg) {
        const box = document.getElementById('term-box');
        box.innerHTML += `<div>[${new Date().toLocaleTimeString()}] ${msg}</div>`;
        box.scrollTop = box.scrollHeight;
    }

    async function startDeepAnalysis() {
        document.getElementById('scanner').style.display = 'block';
        writeLog("Spektral sensörler kalibre ediliyor...");
        
        for(let i=0; i<5; i++) {
            await new Promise(r => setTimeout(r, 1500));
            const lat = 38.2052 + (Math.random() - 0.5) * 0.1;
            const lng = 37.1986 + (Math.random() - 0.5) * 0.1;
            
            const anomali = { lat, lng, id: i+1 };
            foundLocations.push(anomali);
            
            L.circle([lat, lng], { color: '#00ff88', radius: 300 }).addTo(map)
             .bindPopup(`Bulgu #${i+1}`);
            
            document.getElementById('detect-count').innerText = foundLocations.length;
            writeLog(`ANOMALİ TESPİT EDİLDİ: ${lat.toFixed(4)}, ${lng.toFixed(4)}`);
        }
        document.getElementById('scanner').style.display = 'none';
        writeLog("Analiz tamamlandı. Veriler KML için hazır.");
    }

    function exportKML() {
        if(foundLocations.length === 0) { alert("Önce analiz yapmalısınız!"); return; }
        
        let kmlContent = `<?xml version="1.0" encoding="UTF-8"?>
        <kml xmlns="http://www.opengis.net/kml/2.2">
        <Document><name>IP-ArchaeoVision Bulguları</name>`;
        
        foundLocations.forEach(loc => {
            kmlContent += `<Placemark>
                <name>Bulgu #${loc.id}</name>
                <Point><coordinates>${loc.lng},${loc.lat},0</coordinates></Point>
            </Placemark>`;
        });

        kmlContent += `</Document></kml>`;
        
        const blob = new Blob([kmlContent], { type: 'application/vnd.google-earth.kml+xml' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'Elbistan_Arkeo_Bulgular.kml';
        a.click();
        writeLog("KML dosyası dışa aktarıldı.");
    }
</script>
</body>
</html>
